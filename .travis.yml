sudo: false
language: java
jdk:
- oraclejdk8
addons:
  apt:
    packages:
    - rpm
install: mvn install -DskipTests=true -Dmaven.javadoc.skip=true -Dskip.web.build=true
  -B -V
script: mvn package verify -Dskip.web.build=true -B -V
before_deploy:
- mvn jdeb:jdeb && export RELEASE_DEB_FILE=$(ls target/*.deb)
- mvn rpm:rpm && export RELEASE_RPM_FILE=$(find target/ -name '*.rpm' | tail -1)
- rm -f target/original-*.jar
- export RELEASE_PKG_FILE=$(ls target/*.jar)
- echo "Deploying release to GitHub releases"
deploy:
  provider: releases
  api_key:
    secure: o626pv+kN9uCyndmGNysMp41x5cADA1PTBmJEfQ1ogUbo7EVlnmBGZwe6uxSMKhPzxabwrzpnG+cFrruJxmas9s8fSxsb5tEwPl8ouqwAJSffs7Q9tJ4xjX6CnE/+zJFaE5d0ky9DmSjEHmO4AfTrzrcUnbdEzZRkdJn0uyNbe4Kefyv6hu3/ysVLWLU49z+NtOc9dioSuyOwVXD+fg8+KYzPwT1pmqUVrxbTVP2NedI47XHcnq7jyqnguH6H5VKNyRZyv/A2XGe5Pb8zjdtXiTfzXJESrP0/ZQOWrVLJHd67Yeg+N8QJKi2SCPnv9Dd01BE4tMc8gbBOTJErW54EKWbJxDfJ4PN1r47QU5ftgN1PzdJsII6DaNN3fQFJMnEkaSOH/MMO7D/b8thggy73K14B7fNHt2PJSJDKBYCe1woGEekkzZeqcRwtkoMYwsqE+7SMbbqqsqCnMoJtf6Qlx0nbiH735KnMuNCYTRh18bJXA7KFasJwRYxtnpyuE1wOPLyzlTtWdvQYivjsxOLZ8ivINTNB3xvTjRTwCA/ryv3xII3SpkSNqCR4/GQSCI53pUTPscedMlMpkIl/xcOGPJPjgij58H+B6iPfiPVd39K3DF0BrL+AtM4ti/GwTHaFquJSZ3Q75rYN/KsbnNAwLnumJ8hrLKN2ctkvJzblxM=
  file: graylog-plugin-collector-2.4.0-SNAPSHOT.jar
  on:
    repo: silenceper/graylog-plugin-collector
